<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>해보자 슬라이더</title>
</head>
<style>
	* {
		margin:0;
		padding:0;
	}
	body {
		background-color: #f8f8f8;
	}
	#wrap {
		margin: 50px auto;
	}

	

	/************** S임시 **************/
	
	.slide_item {
		display: block;
		height: 500px;
		color: #fff;
		text-align: center;
		font-size: 45px;
		text-shadow: 1px 1px #000;
	}

	.slider_thumb button.on {
		background-color: black;
		color: #fff;
	}

	.slider_thumb {
		width: 700px;
		background-color: aquamarine;
		border: 1px solid #ccc;
		margin: 20px ;
	}
	/************** E임시 **************/
	.slider_top,
	.slider_wrap {
		width: 100%;
		overflow: hidden;
	}
	.slider_inner {
		overflow-x: hidden;
	}

	.slider_inner:after,
	.thumb_inner:after {
		display: block;
		clear: both;
		content: '';
	}

	.slider_thumb {
		overflow: hidden;
	}

	.thumb_inner {
		white-space: nowrap;
		font-size: 0;
	}

	.slide_item {
		float: left;
	}

	.item_pager {
		display: inline-block;
		font-size: 14px;
		box-sizing: border-box;
		border: 0;
	}

	.hide {
		display: none;
	}
</style>
<body>
	<div id="wrap">
		<div class="slider_top">
			<div class="slider_inner">
				<a href="#;" class="slide_item" style="background: red">1번</a>
				<a href="#;" class="slide_item" style="background: blue">2번</a>
				<a href="#;" class="slide_item" style="background: green">3번</a>
				<a href="#;" class="slide_item" style="background: yellow">4번</a>
				<a href="#;" class="slide_item" style="background: purple">5번</a>
				<a href="#;" class="slide_item" style="background: pink">6번</a>
				<a href="#;" class="slide_item" style="background: aqua">7번</a>
				<a href="#;" class="slide_item" style="background: bisque">8번</a>
				<a href="#;" class="slide_item" style="background: bisque">9번</a>
			</div>
		</div>
		<div class="slider_thumb">
			<div class="thumb_inner">
				<button class="on item_pager"><span>1번</span></button>
				<button class="item_pager"><span>2번</span></button>
				<button class="item_pager"><span>3번</span></button>
				<button class="item_pager"><span>4번</span></button>
				<button class="item_pager"><span>5번</span></button>
				<button class="item_pager"><span>6번</span></button>
				<button class="item_pager"><span>7번</span></button>
				<button class="item_pager"><span>8번</span></button>
				<button class="item_pager"><span>9번</span></button>
			</div>
		</div>
		<div class="slider_arrow" style="margin-top:10px;">
			<button class="btn_slider btn_prev"><span>이전</span></button>
			<button class="btn_slider btn_next"><span>다음</span></button>
		</div>
	</div>
</body>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
<script>
	var _count = 0,
	_slider, //setinterval 용
	_index, // 갯수 세기용
	_nowSlider; // 현재 확인용

	$(function(){
		var $sliderInner = $('.slider_inner'), // 슬라이드 내부
			$sectionWith = $('.slider_top').innerWidth(),// 전체 넓이
			$item = $sliderInner.children(),// 슬라이더 아이템 지정
			$Length = $item.length, // 갯수 구하기
			// 페이저(썸네일)
			$thumb = $('.thumb_inner'),
			$thumbWidth = $thumb.innerWidth(), // 썸네일 warp 넓이
			$thumbItem = $thumb.children(), //
			$pagerWidth = ($thumbWidth/$Length)

		// 슬라이더 아이템 넓이 지정
		$item.each(function(){
			var $index = $(this).index();
			$(this).css({ 
				'width':$sectionWith
			}).attr('data-index',$index);
		});

		// 위에서 각각 넓이를 지정한 후  그 값을 곱하여  감싸고 있는부모에게 제공
		var  $width = $item.innerWidth(),
		$fullWidth = ($Length * $width); 
		
		$sliderInner.wrap('<div class="slider_wrap"></div>').css({
			'width':$fullWidth,
		});
		
		// 썸네일 갯수에 따른 넓이 자동 지정, 4개 미만일경우 갯수/100%
		if($Length > 4) {
			$thumbItem.css('width',($thumbWidth/4));
		} else {
			$thumbItem.css('width',$pagerWidth)
		}

		// 각각에 
		$thumbItem.each(function(){
			$(this).attr('data-thumIndex',$(this).index());
		});

		if($Length > 4) {
			var $pagerAdd = (4-$Length % 4)
		}

		// 자동 롤릴
		function autoSlider(){
			_slider = setInterval(function(){
				_index = $('.slide_item').eq(1).data('index'); 
				// console.log(_index);
				nextSlider();
			},1000);
		}

		// 다음
		function nextSlider(){
			$sliderInner.append($('.slide_item:first()').clone());
			$('.slide_item:first()').remove();
			onChangePager();
			console.log(`이미지 바뀐다 next 의 인덱스 ${_index}`);
		}

		// 이전
		function prevSlider(){
			$sliderInner.prepend($('.slide_item:eq('+($item.length-1)+')').clone());
			$('.slide_item:last()').remove();
			onChangePager();
			console.log(`이미지 바뀐다 prev 의 인덱스 ${_index}`);
		}


		function onChangePager(){
			$('.item_pager').removeClass('on');
			$('.item_pager[data-thumIndex='+_index+']').addClass('on');
			console.log(`클래스 추가다 의 인덱스 ${_index}`);
		}
		
		autoSlider();

		for(i =0; i <= $pagerAdd-1; i++){
			var readyItem = $thumbItem.eq(i).clone().removeClass('on');
			$thumb.append(readyItem);
		}
		
		// 페이저 버튼 처리
		$thumb.on('click', '.item_pager', function(){
			var $this = $(this),
			$index = $this.data('thumIndex');
			$(this).addClass('on').siblings().removeClass('on');
			$('.slide_item').eq($index).removeClass('hide').siblings().addClass('hide');
			_nowSlider = $('.slide_item:not(.hide)').data('index');
		});

		// 버튼 처리
		$('.btn_slider').click(function(){
			clearInterval(_slider);
			$('.slide_item').removeClass('hide');
			
			var $this = $(this);
			
			if($this.hasClass('btn_next')){
				nextSlider();
			} else {
				prevSlider();
			}
			_index = $('.slide_item').eq(1).data('index'); 
			console.log(_index);
			onChangePager();
		});

		$(window).resize(function(){
			var $window = $(window).width();
			$('.slide_item').css('width',$window);
			$sliderInner.css({
				'width':$Length*$window,
			});
		});
	});
</script>
</html>